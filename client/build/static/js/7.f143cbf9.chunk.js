(this["webpackJsonpreact-social-network"]=this["webpackJsonpreact-social-network"]||[]).push([[7],{265:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var s=t(33),n=(t(0),t(266)),c=t.n(n),i=t(17),r=t(1),o=function(e){var a=e.name,t=e.label,n=e.rules,o=e.control,l=e.rows,d=void 0===l?2:l,j=e.disabled,u=void 0!==j&&j,m=e.placeholder;return Object(r.jsx)(s.a,{control:o,name:a,rules:n,render:function(e){var a=e.field,s=e.fieldState;return Object(r.jsx)(i.d,{label:t,required:!(null===n||void 0===n||!n.required),error:s.error,disabled:u,children:Object(r.jsx)("textarea",{className:"".concat(c.a.textarea," ").concat(s.error?c.a.error:""),name:a.name,value:a.value,onChange:a.onChange,rows:d,disabled:u,placeholder:m})})}})}},266:function(e,a,t){e.exports={dark:"InputTextarea_dark__c3Uh-",textarea:"InputTextarea_textarea__29Lkx",error:"InputTextarea_error__7n4iw"}},366:function(e,a,t){e.exports={dark:"Dialogs_dark__1xs_7",dialogs:"Dialogs_dialogs__3nzna",dialogsList:"Dialogs_dialogsList__1s20C",listActive:"Dialogs_listActive__2n8FH",dialogsListSwitch:"Dialogs_dialogsListSwitch__1ekHK",header:"Dialogs_header__ESqgA",newMessageForm:"Dialogs_newMessageForm__1L--7",messages:"Dialogs_messages__1XU6V"}},367:function(e,a,t){e.exports={dark:"NewMessageForm_dark__1Dm9s",newMessageForm:"NewMessageForm_newMessageForm__2u-OS"}},368:function(e,a,t){e.exports={dark:"Message_dark__3RzVL",messageOther:"Message_messageOther__3fTLP",messageSelf:"Message_messageSelf__1NjeZ",messageAvatar:"Message_messageAvatar__ekUyS",messageAuthorName:"Message_messageAuthorName__3SqBH"}},370:function(e,a,t){e.exports={dark:"DialogButton_dark__1fPBj",dialogButton:"DialogButton_dialogButton__1fLgP",active:"DialogButton_active__SVkhj"}},386:function(e,a,t){"use strict";t.r(a);var s=t(5),n=t(10),c=t(0),i=t(366),r=t.n(i),o=t(367),l=t.n(o),d=t(9),j=t(17),u=t(265),m=t(1),b=function(e){var a=e.onSubmit;return Object(m.jsx)(j.a,{onSubmit:function(e){a(e.newMessageInput)},initialValues:{newMessageInput:""},resetAfterSubmit:!0,submitOnEnter:!0,children:Object(m.jsxs)(j.b,{children:[Object(m.jsx)(u.a,{name:"newMessageInput"}),Object(m.jsx)("div",{className:l.a.button,children:Object(m.jsx)(d.a,{children:"Send"})})]})})},g=t(49),O=t(382),h=t(254),x=t(14),_=t.n(x),f=t(368),v=t.n(f),p=t(18),N=t(43),w=t(369),S=t.n(w),k=t(55),A=t(50),M=t(92),D=t(380),I=t(381),L=function(e){var a=e.message,t=e.authUser===a.author.username,s=Object(p.b)(),i=Object(c.useState)(!1),r=Object(n.a)(i,2),o=r[0],l=r[1];return Object(c.useEffect)((function(){!o||a.isRead||t||s(Object(N.e)(a._id))}),[o]),Object(m.jsx)(S.a,{onChange:function(e){l(e),o&&!a.isRead&&s(Object(N.e)(a.dialog))},children:Object(m.jsx)("div",{className:t?v.a.messageSelf:v.a.messageOther,children:Object(m.jsxs)(k.b,{gap:10,children:[Object(m.jsx)("div",{className:v.a.messageAvatar,children:Object(m.jsx)(A.a,{online:Object(M.a)(a.author.updatedAt),smallImg:a.author.avatar.small,size:30})}),Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{className:v.a.messageAuthorName,children:a.author.firstName}),Object(m.jsx)("div",{children:a.text})]}),Object(m.jsx)(k.c,{}),Object(m.jsx)("div",{children:a.isRead?Object(m.jsx)(D.a,{}):Object(m.jsx)(I.a,{})})]})})})},C=t(370),F=t.n(C),B=t(20),z=function(e){var a=e.username,t=e.firstName,s=e.lastName,n=e.avatar;return Object(m.jsx)(B.b,{to:"/dialogs/".concat(a),className:F.a.dialogButton,activeClassName:F.a.active,title:"".concat(t," ").concat(s),children:Object(m.jsx)(A.a,{size:30,name:Object(M.c)(t,8),smallImg:n.small})})},U=function(e){var a=e.companion;return Object(m.jsxs)(k.b,{padding:10,verticalAlign:"center",children:[Object(m.jsx)(k.c,{}),Object(m.jsx)(k.a,{children:Object(m.jsxs)("div",{style:{fontWeight:700},children:[null===a||void 0===a?void 0:a.firstName," ",null===a||void 0===a?void 0:a.lastName]})}),Object(m.jsx)(k.c,{}),Object(m.jsx)(A.a,{online:Object(M.a)(null===a||void 0===a?void 0:a.updatedAt),smallImg:null===a||void 0===a?void 0:a.avatar.small,size:36})]})},E=function(e){var a=e.messages,t=e.dialogs,i=e.authUser,o=e.onNewMessageSubmit,l=e.currentCompanion,j=Object(c.useState)(!1),u=Object(n.a)(j,2),x=u[0],f=u[1];return Object(m.jsx)(g.a,{children:Object(m.jsxs)("div",{className:_()(r.a.dialogs,Object(s.a)({},r.a.listActive,x)),children:[Object(m.jsxs)("div",{className:r.a.header,children:[Object(m.jsxs)("div",{className:r.a.dialogsListSwitch,children:[!x&&Object(m.jsx)(d.a,{type:"text",size:"xl",onClick:function(){return f(!0)},children:Object(m.jsx)(d.a.Icon,{children:Object(m.jsx)(O.a,{width:22,height:22})})}),x&&Object(m.jsx)(d.a,{type:"text",size:"xl",onClick:function(){return f(!1)},children:Object(m.jsx)(d.a.Icon,{children:Object(m.jsx)(h.a,{width:22,height:22})})})]}),!!l&&Object(m.jsx)(U,{companion:l})]}),Object(m.jsx)("div",{className:_()(r.a.dialogsList,Object(s.a)({},r.a.listActive,x)),children:t.map((function(e){return Object(m.jsx)(z,{username:e.companion.username,firstName:e.companion.firstName,lastName:e.companion.lastName,avatar:e.companion.avatar},e._id)}))}),Object(m.jsx)("div",{className:r.a.messages,children:a.slice().reverse().map((function(e){return Object(m.jsx)(L,{message:e,authUser:i},e._id)}))}),Object(m.jsx)("div",{className:r.a.newMessageForm,children:Object(m.jsx)(b,{onSubmit:o})})]})})},q=t(19),y=t(64),R=t(305);a.default=function(){var e,a=Object(q.g)().username,t=Object(p.c)((function(e){return e.dialogs.dialogs.slice().sort((function(e,a){var t=new Date(e.updatedAt),s=new Date(a.updatedAt);return t>s?-1:t<s?1:0}))})),s=Object(p.c)((function(e){return e.dialogs.currentDialogId})),n=Object(p.c)((function(e){var a;return null===(a=e.auth.user)||void 0===a?void 0:a.username})),i=Object(p.c)((function(e){return e.dialogs.messages})),r=null===(e=t.find((function(e){return e.companion.username===a})))||void 0===e?void 0:e.companion,o=Object(p.b)();return Object(c.useEffect)((function(){return o(Object(N.d)(a)),function(){o(Object(N.a)())}}),[a,o]),Object(c.useEffect)((function(){o(Object(N.c)())}),[o]),Object(c.useEffect)((function(){}),[i,o]),Object(y.a)()?!a&&t[0]&&0!==t.length?Object(m.jsx)(q.a,{to:"/dialogs/".concat(t[0].companion.username)}):Object(m.jsxs)(m.Fragment,{children:[r&&Object(m.jsx)(R.a,{children:Object(m.jsxs)("title",{children:["Dialog - ",r.firstName," ",r.lastName]})}),Object(m.jsx)(E,{messages:i,dialogs:t,currentCompanion:r,authUser:n||"",onNewMessageSubmit:function(e){e.trim()&&s&&o(Object(N.f)(e.trim(),s))}})]}):Object(m.jsx)(q.a,{to:"/login"})}}}]);
//# sourceMappingURL=7.f143cbf9.chunk.js.map