(this["webpackJsonpreact-social-network"]=this["webpackJsonpreact-social-network"]||[]).push([[8],{263:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a(20),n=a(0),c=a(31),i=s.c,r=function(){var e=Object(s.b)();return Object(n.useEffect)((function(){e(Object(c.c)())}),[e]),i((function(e){return e.auth.authorized}))}},264:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a(34),n=(a(0),a(269)),c=a.n(n),i=a(18),r=a(1),o=function(e){var t=e.name,a=e.label,n=e.rules,o=e.control,l=e.rows,u=void 0===l?2:l,d=e.disabled,j=void 0!==d&&d,b=e.placeholder;return Object(r.jsx)(s.a,{control:o,name:t,rules:n,render:function(e){var t=e.field,s=e.fieldState;return Object(r.jsx)(i.d,{label:a,required:!(null===n||void 0===n||!n.required),error:s.error,disabled:j,children:Object(r.jsx)("textarea",{className:"".concat(c.a.textarea," ").concat(s.error?c.a.error:""),name:t.name,value:t.value,onChange:t.onChange,rows:u,disabled:j,placeholder:b})})}})}},269:function(e,t,a){e.exports={dark:"InputTextarea_dark__1Bvup",textarea:"InputTextarea_textarea__3KxMk",error:"InputTextarea_error__lL7Wo"}},369:function(e,t,a){e.exports={dark:"Dialogs_dark__2e1-h",dialogs:"Dialogs_dialogs__2Gkkf",dialogsList:"Dialogs_dialogsList__2Ipwc",listActive:"Dialogs_listActive__2-6kS",dialogsListSwitch:"Dialogs_dialogsListSwitch__3k4Uj",header:"Dialogs_header__xjhog",newMessageForm:"Dialogs_newMessageForm__19zd-",messages:"Dialogs_messages__1J3nn"}},370:function(e,t,a){e.exports={dark:"NewMessageForm_dark__2tbhf",newMessageForm:"NewMessageForm_newMessageForm__RJt-t"}},371:function(e,t,a){e.exports={dark:"Message_dark__TqOZM",messageOther:"Message_messageOther__2ClsO",messageSelf:"Message_messageSelf__1RCL9",messageAvatar:"Message_messageAvatar__3Rf_d",messageAuthorName:"Message_messageAuthorName__2nozg"}},373:function(e,t,a){e.exports={dark:"DialogButton_dark__12RPZ",dialogButton:"DialogButton_dialogButton__1280a",active:"DialogButton_active__3QzMS"}},394:function(e,t,a){"use strict";a.r(t);var s=a(5),n=a(10),c=a(0),i=a(369),r=a.n(i),o=a(370),l=a.n(o),u=a(9),d=a(18),j=a(264),b=a(1),m=function(e){var t=e.onSubmit;return Object(b.jsx)(d.a,{onSubmit:function(e){t(e.newMessageInput)},initialValues:{newMessageInput:""},resetAfterSubmit:!0,submitOnEnter:!0,children:Object(b.jsxs)(d.b,{children:[Object(b.jsx)(j.a,{name:"newMessageInput"}),Object(b.jsx)("div",{className:l.a.button,children:Object(b.jsx)(u.a,{children:"Send"})})]})})},g=a(50),O=a(390),h=a(253),x=a(14),f=a.n(x),_=a(371),v=a.n(_),p=a(20),N=a(44),w=a(372),k=a.n(w),M=a(29),S=a(51),A=a(89),D=a(388),I=a(389),C=function(e){var t=e.message,a=e.authUser===t.author.username,s=Object(p.b)(),i=Object(c.useState)(!1),r=Object(n.a)(i,2),o=r[0],l=r[1];return Object(c.useEffect)((function(){!o||t.isRead||a||s(Object(N.e)(t._id))}),[o]),Object(b.jsx)(k.a,{onChange:function(e){l(e),o&&!t.isRead&&s(Object(N.e)(t.dialog))},children:Object(b.jsx)("div",{className:a?v.a.messageSelf:v.a.messageOther,children:Object(b.jsxs)(M.b,{gap:10,children:[Object(b.jsx)("div",{className:v.a.messageAvatar,children:Object(b.jsx)(S.a,{online:Object(A.a)(t.author.updatedAt),smallImg:t.author.avatar.small,size:30})}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:v.a.messageAuthorName,children:t.author.firstName}),Object(b.jsx)("div",{children:t.text})]}),Object(b.jsx)(M.c,{}),Object(b.jsx)("div",{children:t.isRead?Object(b.jsx)(D.a,{}):Object(b.jsx)(I.a,{})})]})})})},z=a(373),F=a.n(z),L=a(17),B=function(e){var t=e.username,a=e.firstName,s=e.lastName,n=e.avatar;return Object(b.jsx)(L.b,{to:"/dialogs/".concat(t),className:F.a.dialogButton,activeClassName:F.a.active,title:"".concat(a," ").concat(s),children:Object(b.jsx)(S.a,{size:30,name:Object(A.c)(a,8),smallImg:n.small})})},R=function(e){var t=e.companion;return Object(b.jsxs)(M.b,{padding:10,verticalAlign:"center",children:[Object(b.jsx)(M.c,{}),Object(b.jsx)(M.a,{children:Object(b.jsxs)("div",{style:{fontWeight:700},children:[null===t||void 0===t?void 0:t.firstName," ",null===t||void 0===t?void 0:t.lastName]})}),Object(b.jsx)(M.c,{}),Object(b.jsx)(S.a,{online:Object(A.a)(null===t||void 0===t?void 0:t.updatedAt),smallImg:null===t||void 0===t?void 0:t.avatar.small,size:36})]})},E=function(e){var t=e.messages,a=e.dialogs,i=e.authUser,o=e.onNewMessageSubmit,l=e.currentCompanion,d=Object(c.useState)(!1),j=Object(n.a)(d,2),x=j[0],_=j[1];return Object(b.jsx)(g.a,{children:Object(b.jsxs)("div",{className:f()(r.a.dialogs,Object(s.a)({},r.a.listActive,x)),children:[Object(b.jsxs)("div",{className:r.a.header,children:[Object(b.jsxs)("div",{className:r.a.dialogsListSwitch,children:[!x&&Object(b.jsx)(u.a,{type:"text",size:"xl",onClick:function(){return _(!0)},children:Object(b.jsx)(u.a.Icon,{children:Object(b.jsx)(O.a,{width:22,height:22})})}),x&&Object(b.jsx)(u.a,{type:"text",size:"xl",onClick:function(){return _(!1)},children:Object(b.jsx)(u.a.Icon,{children:Object(b.jsx)(h.a,{width:22,height:22})})})]}),!!l&&Object(b.jsx)(R,{companion:l})]}),Object(b.jsx)("div",{className:f()(r.a.dialogsList,Object(s.a)({},r.a.listActive,x)),children:a.map((function(e){return Object(b.jsx)(B,{username:e.companion.username,firstName:e.companion.firstName,lastName:e.companion.lastName,avatar:e.companion.avatar},e._id)}))}),Object(b.jsx)("div",{className:r.a.messages,children:t.slice().reverse().map((function(e){return Object(b.jsx)(C,{message:e,authUser:i},e._id)}))}),Object(b.jsx)("div",{className:r.a.newMessageForm,children:Object(b.jsx)(m,{onSubmit:o})})]})})},U=a(19),J=a(303),T=a(263);t.default=function(){var e,t=Object(U.g)().username,a=Object(p.c)((function(e){return e.dialogs.dialogs.slice().sort((function(e,t){var a=new Date(e.updatedAt),s=new Date(t.updatedAt);return a>s?-1:a<s?1:0}))})),s=Object(p.c)((function(e){return e.dialogs.currentDialogId})),n=Object(p.c)((function(e){var t;return null===(t=e.auth.user)||void 0===t?void 0:t.username})),i=Object(p.c)((function(e){return e.dialogs.messages})),r=null===(e=a.find((function(e){return e.companion.username===t})))||void 0===e?void 0:e.companion,o=Object(p.b)();return Object(c.useEffect)((function(){return o(Object(N.d)(t)),function(){o(Object(N.a)())}}),[t,o]),Object(c.useEffect)((function(){o(Object(N.c)())}),[o]),Object(c.useEffect)((function(){}),[i,o]),Object(T.a)()?!t&&a[0]&&0!==a.length?Object(b.jsx)(U.a,{to:"/dialogs/".concat(a[0].companion.username)}):Object(b.jsxs)(b.Fragment,{children:[r&&Object(b.jsx)(J.a,{children:Object(b.jsxs)("title",{children:["Dialog - ",r.firstName," ",r.lastName]})}),Object(b.jsx)(E,{messages:i,dialogs:a,currentCompanion:r,authUser:n||"",onNewMessageSubmit:function(e){e.trim()&&s&&o(Object(N.f)(e.trim(),s))}})]}):Object(b.jsx)(U.a,{to:"/login"})}}}]);
//# sourceMappingURL=8.2e1d34e3.chunk.js.map