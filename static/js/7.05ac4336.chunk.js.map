{"version":3,"sources":["components/_shared/Flex/Flex.tsx","components/_shared/Input/InputTextarea/InputTextarea.tsx","components/_shared/Input/InputTextarea/InputTextarea.module.scss","components/_shared/Flex/Flex.module.scss","components/Dialogs/Dialogs.module.scss","components/_forms/NewMessageForm/NewMessageForm.module.scss","components/Dialogs/Message/Message.module.scss","components/Dialogs/DialogButton/DialogButton.module.scss","components/_forms/NewMessageForm/NewMessageForm.tsx","components/Dialogs/Message/Message.tsx","components/Dialogs/DialogButton/DialogButton.tsx","components/Dialogs/DialogHeader/DialogHeader.tsx","components/Dialogs/Dialogs.tsx","components/_pages/DialogsPage.tsx"],"names":["Row","children","verticalAlign","horizontalAlign","padding","gap","bordered","className","classnames","classes","row","style","alignItems","justifyContent","Array","map","child","index","React","cloneElement","key","marginRight","length","props","col","Col","stretch","flex","undefined","Children","item","marginBottom","Space","space","InputTextarea","name","label","rules","control","rows","disabled","placeholder","render","field","fieldState","required","error","textarea","value","onChange","module","exports","NewMessageForm","onSubmit","Form","data","newMessageInput","initialValues","resetAfterSubmit","submitOnEnter","button","Button","Message","message","isAuthor","authUser","author","username","dispatch","useDispatch","useState","visible","setVisible","useEffect","isRead","readMessage","_id","isVisible","dialog","messageSelf","messageOther","messageAvatar","Avatar","online","checkOnline","updatedAt","smallImg","avatar","small","size","messageAuthorName","firstName","text","DialogButton","lastName","to","dialogButton","activeClassName","active","title","trimString","DialogHeader","companion","fontWeight","Dialogs","messages","dialogs","onNewMessageSubmit","currentCompanion","listActive","setListActive","Card","header","dialogsListSwitch","type","onClick","Icon","width","height","dialogsList","d","slice","reverse","newMessageForm","DialogsPage","useParams","useSelector","state","sort","a","b","dateA","Date","dateB","currentDialogId","auth","user","find","openDialog","closeDialog","getDialogs","useAuthCheck","Helmet","trim","sendMessage"],"mappings":"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","file":"static/js/7.05ac4336.chunk.js","sourcesContent":["import React, {CSSProperties} from 'react'\r\nimport classes from 'components/_shared/Flex/Flex.module.scss'\r\nimport classnames from 'classnames'\r\n\r\ntype RowProps = {\r\n    children?: Array<React.ReactElement | boolean> | React.ReactElement | boolean\r\n    verticalAlign?: 'start' | 'end' | 'center' | 'space-between' | 'space-around'\r\n    horizontalAlign?: 'start' | 'end' | 'center' | 'space-between' | 'space-around'\r\n    padding?: number | string\r\n    margin?: number | string\r\n    gap?: number\r\n    bordered?: boolean\r\n}\r\n\r\nexport const Row: React.FC<RowProps> = ({\r\n                                            children,\r\n                                            verticalAlign = 'start',\r\n                                            horizontalAlign = 'start',\r\n                                            padding = 0,\r\n                                            gap = 0,\r\n                                            bordered\r\n                                        }) => {\r\n    return <div\r\n        className={classnames(\r\n            classes.row,\r\n            {[classes.bordered]: bordered})\r\n        }\r\n        style={{\r\n            alignItems: 'stretch',\r\n            justifyContent: horizontalAlign,\r\n            padding\r\n        }}\r\n    >\r\n        {(children instanceof Array) && children.map((child, index) => {\r\n                if (typeof child === 'boolean') return false\r\n                return React.cloneElement(child, {\r\n                    key: index,\r\n                    style: {\r\n                        marginRight: (index === children.length - 1) ? 0 : gap,\r\n                        justifyContent: verticalAlign\r\n                    },\r\n                    className: child.props.className + ' ' + classes.col\r\n                })\r\n            }\r\n        )}\r\n\r\n        {children && typeof children !== 'boolean' && !(children instanceof Array) &&\r\n            React.cloneElement(children, {\r\n                style: {\r\n                    marginRight: 0,\r\n                    justifyContent: verticalAlign\r\n                },\r\n                className: children.props.className + ' ' + classes.col\r\n            })\r\n        }\r\n    </div>\r\n}\r\n\r\ntype ColProps = {\r\n    verticalAlign?: 'start' | 'end' | 'center' | 'space-between' | 'space-around'\r\n    horizontalAlign?: 'start' | 'end' | 'center' | 'baseline' | 'stretch'\r\n    style?: CSSProperties,\r\n    padding?: number | string,\r\n    gap?: number,\r\n    bordered?: boolean,\r\n    stretch?: boolean,\r\n}\r\n\r\nexport const Col: React.FC<ColProps> = ({\r\n                                            children,\r\n                                            style,\r\n                                            verticalAlign,\r\n                                            horizontalAlign = 'start',\r\n                                            padding = 0,\r\n                                            gap = 0,\r\n                                            bordered,\r\n    stretch= false\r\n                                        }) => {\r\n\r\n    return <div className={classnames(classes.col, {[classes.bordered]: bordered})} style={{\r\n        padding,\r\n        marginRight: style?.marginRight,\r\n        alignItems: horizontalAlign,\r\n        justifyContent: verticalAlign ? verticalAlign : style?.justifyContent,\r\n        flex: stretch ? 1 : undefined\r\n    }}>\r\n\r\n        {React.Children.map(children, child => <div className={classes.item} style={{marginBottom: gap}}>\r\n            {child}\r\n        </div>)}\r\n    </div>\r\n}\r\n\r\nexport const Space: React.FC = () => {\r\n    return <div className={classes.space}/>\r\n}\r\n","import {Controller, RegisterOptions} from 'react-hook-form'\r\nimport {Control} from 'react-hook-form/dist/types/form'\r\nimport React from 'react'\r\nimport classes from './InputTextarea.module.scss'\r\nimport {Item} from 'components/_shared/Form/Form'\r\n\r\nexport type InputTextareaPropsType = {\r\n    name: string,\r\n    label?: string,\r\n    placeholder?: string,\r\n    rules?: RegisterOptions,\r\n    control?: Control,\r\n    rows?: number,\r\n    disabled?: boolean\r\n}\r\nexport const InputTextarea: React.FC<InputTextareaPropsType> = ({\r\n                                                                    name,\r\n                                                                    label,\r\n                                                                    rules,\r\n                                                                    control,\r\n                                                                    rows = 2,\r\n                                                                    disabled = false,\r\n    placeholder\r\n                                                                }) => {\r\n    return <Controller\r\n        control={control}\r\n        name={name}\r\n        rules={rules}\r\n        render={({field, fieldState}) => <Item label={label} required={!!rules?.required} error={fieldState.error}\r\n                                               disabled={disabled}>\r\n            <textarea\r\n                className={`${classes.textarea} ${fieldState.error ? classes.error : ''}`}\r\n                name={field.name}\r\n                value={field.value}\r\n                onChange={field.onChange}\r\n                rows={rows}\r\n                disabled={disabled}\r\n                placeholder={placeholder}\r\n            />\r\n        </Item>}\r\n    />\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"InputTextarea_dark__c3Uh-\",\"textarea\":\"InputTextarea_textarea__29Lkx\",\"error\":\"InputTextarea_error__7n4iw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"Flex_dark__10I9f\",\"row\":\"Flex_row__3_1u3\",\"bordered\":\"Flex_bordered__1vTO2\",\"col\":\"Flex_col__1rgou\",\"item\":\"Flex_item__3eYY8\",\"space\":\"Flex_space__2U2zF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"Dialogs_dark__1xs_7\",\"dialogs\":\"Dialogs_dialogs__3nzna\",\"dialogsList\":\"Dialogs_dialogsList__1s20C\",\"listActive\":\"Dialogs_listActive__2n8FH\",\"dialogsListSwitch\":\"Dialogs_dialogsListSwitch__1ekHK\",\"header\":\"Dialogs_header__ESqgA\",\"newMessageForm\":\"Dialogs_newMessageForm__1L--7\",\"messages\":\"Dialogs_messages__1XU6V\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"NewMessageForm_dark__1Dm9s\",\"newMessageForm\":\"NewMessageForm_newMessageForm__2u-OS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"Message_dark__3RzVL\",\"messageOther\":\"Message_messageOther__3fTLP\",\"messageSelf\":\"Message_messageSelf__1NjeZ\",\"messageAvatar\":\"Message_messageAvatar__ekUyS\",\"messageAuthorName\":\"Message_messageAuthorName__3SqBH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dark\":\"DialogButton_dark__1fPBj\",\"dialogButton\":\"DialogButton_dialogButton__1fLgP\",\"active\":\"DialogButton_active__SVkhj\"};","import classes from './NewMessageForm.module.scss'\r\nimport React from \"react\";\r\nimport {Button} from 'components/_shared/Button/Button'\r\nimport {Form, FormRow} from 'components/_shared/Form/Form'\r\nimport {InputTextarea} from 'components/_shared/Input/InputTextarea/InputTextarea'\r\n\r\ntype PropsType = {\r\n    onSubmit: (message: string) => void\r\n}\r\n\r\nconst NewMessageForm: React.FC<PropsType> = ({onSubmit}) => {\r\n\r\n    const submit = (data: { newMessageInput: string }) => {\r\n        onSubmit(data.newMessageInput)\r\n    }\r\n\r\n    return (\r\n        <Form onSubmit={submit} initialValues={{newMessageInput: ``}} resetAfterSubmit={true} submitOnEnter={true}>\r\n            <FormRow>\r\n                <InputTextarea name={'newMessageInput'}/>\r\n                <div className={classes.button}>\r\n                    <Button>Send</Button>\r\n                </div>\r\n            </FormRow>\r\n        </Form>\r\n    )\r\n}\r\n\r\nexport default NewMessageForm","import React, {useEffect, useState} from 'react'\r\nimport classes from './Message.module.scss'\r\nimport {MessageType} from 'types/types'\r\nimport {useDispatch} from 'react-redux'\r\nimport {readMessage} from 'redux/reducers/dialogs.reducer'\r\nimport VisibilitySensor from \"react-visibility-sensor\"\r\nimport {Row, Space} from 'components/_shared/Flex/Flex'\r\nimport {Avatar} from 'components/_shared/Avatar/Avatar'\r\nimport {checkOnline} from 'utils/functions'\r\nimport {Check, CheckAll} from 'react-bootstrap-icons'\r\n\r\ntype Props = { message: MessageType, authUser: string }\r\n\r\nexport const Message: React.FC<Props> = ({message, authUser}) => {\r\n    const isAuthor = authUser === message.author.username\r\n    const dispatch = useDispatch()\r\n    const [visible, setVisible] = useState(false)\r\n\r\n    // todo think better way to read message. for example send 'read-message' event and handle it on server\r\n    const visibilityChangeHandler = (isVisible: boolean) => {\r\n        setVisible(isVisible)\r\n        if (visible && !message.isRead) dispatch(readMessage(message.dialog))\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (visible && !message.isRead && !isAuthor) dispatch(readMessage(message._id))\r\n    }, [visible])\r\n    return (\r\n        <VisibilitySensor onChange={visibilityChangeHandler}>\r\n            <div className={isAuthor ? classes.messageSelf : classes.messageOther}>\r\n                <Row gap={10}>\r\n                    <div className={classes.messageAvatar}>\r\n                        <Avatar online={checkOnline(message.author.updatedAt)} smallImg={message.author.avatar.small} size={30}/>\r\n                    </div>\r\n                    <div>\r\n                        <div className={classes.messageAuthorName}>{message.author.firstName}</div>\r\n                        <div>{message.text}</div>\r\n                    </div>\r\n                    <Space/>\r\n                    <div>\r\n                        {message.isRead ? <CheckAll/> : <Check/>}\r\n                    </div>\r\n                </Row>\r\n            </div>\r\n        </VisibilitySensor>\r\n    )\r\n}","import React from 'react'\r\nimport classes from './DialogButton.module.scss'\r\nimport {AvatarType} from 'types/types'\r\nimport {NavLink} from 'react-router-dom'\r\nimport {Avatar} from 'components/_shared/Avatar/Avatar'\r\nimport {trimString} from 'utils/functions'\r\n\r\ntype Props = { username: string, firstName: string, lastName: string, avatar: AvatarType }\r\nexport const DialogButton: React.FC<Props> = ({username, firstName, lastName, avatar}) => {\r\n    return (\r\n        <NavLink to={`/dialogs/${username}`} className={classes.dialogButton} activeClassName={classes.active} title={`${firstName} ${lastName}`}>\r\n            <Avatar size={30} name={trimString(firstName, 8)} smallImg={avatar.small}/>\r\n        </NavLink>\r\n    )\r\n}","import React from 'react'\r\nimport classes from './DialogHeader.module.scss'\r\nimport {Button} from 'components/_shared/Button/Button'\r\nimport {List} from 'react-bootstrap-icons'\r\nimport {Col, Row, Space} from 'components/_shared/Flex/Flex'\r\nimport {Avatar} from 'components/_shared/Avatar/Avatar'\r\nimport {checkOnline} from 'utils/functions'\r\nimport {UserItemDataType} from 'types/types'\r\n\r\ntype Props = {\r\n    companion: UserItemDataType\r\n}\r\n\r\nexport const DialogHeader: React.FC<Props> = ({ companion }) => {\r\n    return <Row padding={10} verticalAlign={'center'}>\r\n        <Space/>\r\n        <Col>\r\n            <div style={{fontWeight: 700}}>\r\n                {companion?.firstName} {companion?.lastName}\r\n            </div>\r\n        </Col>\r\n        <Space/>\r\n        <Avatar online={checkOnline(companion?.updatedAt)} smallImg={companion?.avatar.small} size={36}/>\r\n    </Row>\r\n}","import React, {useState} from 'react'\r\nimport classes from './Dialogs.module.scss'\r\nimport {DialogType, MessageType, UserItemDataType} from 'types/types'\r\nimport NewMessageForm from 'components/_forms/NewMessageForm/NewMessageForm'\r\nimport {Card} from 'components/_shared/Card/Card'\r\nimport {Avatar} from 'components/_shared/Avatar/Avatar'\r\nimport {Button} from 'components/_shared/Button/Button'\r\nimport {ArrowLeft, List} from 'react-bootstrap-icons'\r\nimport classnames from 'classnames'\r\nimport {Message} from 'components/Dialogs/Message/Message'\r\nimport {DialogButton} from 'components/Dialogs/DialogButton/DialogButton'\r\nimport {Col, Row, Space} from 'components/_shared/Flex/Flex'\r\nimport {checkOnline, trimString} from 'utils/functions'\r\nimport {DialogHeader} from 'components/Dialogs/DialogHeader/DialogHeader'\r\nimport {Visibility} from 'components/_shared/Visibility/Visibility'\r\n\r\ntype PropsType = {\r\n    messages: Array<MessageType>\r\n    dialogs: Array<DialogType>\r\n    currentCompanion?: UserItemDataType\r\n    authUser: string\r\n    onNewMessageSubmit: (message: string) => void\r\n}\r\n\r\nconst Dialogs: React.FC<PropsType> = ({messages, dialogs, authUser, onNewMessageSubmit, currentCompanion}) => {\r\n    const [listActive, setListActive] = useState<boolean>(false)\r\n\r\n    const showDialogsList = () => setListActive(true)\r\n    const hideDialogsList = () => setListActive(false)\r\n\r\n\r\n    return (\r\n        <Card>\r\n            <div className={classnames(classes.dialogs, {[classes.listActive]: listActive})}>\r\n\r\n\r\n                <div className={classes.header}>\r\n                    <div className={classes.dialogsListSwitch}>\r\n                        {!listActive && <Button type={'text'} size={'xl'} onClick={showDialogsList}>\r\n                            <Button.Icon><List width={22} height={22}/></Button.Icon>\r\n                        </Button>}\r\n                        {listActive && <Button type={'text'} size={'xl'} onClick={hideDialogsList}>\r\n                            <Button.Icon><ArrowLeft width={22} height={22}/></Button.Icon>\r\n                        </Button>}\r\n                    </div>\r\n                        {!!currentCompanion && <DialogHeader companion={currentCompanion}/>}\r\n                </div>\r\n\r\n                <div className={classnames(classes.dialogsList, {[classes.listActive]: listActive})}>\r\n                    {dialogs.map(d => <DialogButton key={d._id}\r\n                                                    username={d.companion.username}\r\n                                                    firstName={d.companion.firstName}\r\n                                                    lastName={d.companion.lastName}\r\n                                                    avatar={d.companion.avatar}\r\n                    />)}\r\n                </div>\r\n\r\n                <div className={classes.messages}>\r\n                    {messages.slice().reverse().map((message) => <Message key={message._id} message={message}\r\n                                                                          authUser={authUser}/>)}\r\n                </div>\r\n\r\n                <div className={classes.newMessageForm}>\r\n                    <NewMessageForm onSubmit={onNewMessageSubmit}/>\r\n                </div>\r\n\r\n            </div>\r\n        </Card>\r\n    )\r\n}\r\n\r\nexport default Dialogs\r\n","import Dialogs from 'components/Dialogs/Dialogs'\r\nimport React, {useEffect} from 'react'\r\nimport {Redirect, useParams} from 'react-router-dom'\r\nimport {useDispatch, useSelector} from 'react-redux'\r\nimport {StateType} from 'redux/store'\r\nimport {closeDialog, getDialogs, openDialog, sendMessage} from 'redux/reducers/dialogs.reducer'\r\nimport {useAuthCheck} from 'utils/hooks'\r\nimport {Helmet} from 'react-helmet'\r\n\r\n\r\nconst DialogsPage: React.FC = () => {\r\n    const {username}: { username: string } = useParams()\r\n    const dialogs = useSelector((state: StateType) => state.dialogs.dialogs.slice().sort((a, b) => {\r\n        const dateA = new Date(a.updatedAt)\r\n        const dateB = new Date(b.updatedAt)\r\n        if (dateA > dateB) return -1\r\n        if (dateA < dateB) return 1\r\n        return 0\r\n    }))\r\n    const currentDialogId = useSelector((state: StateType) => state.dialogs.currentDialogId)\r\n    const authUser = useSelector((state: StateType) => state.auth.user?.username)\r\n    const messages = useSelector((state: StateType) => state.dialogs.messages)\r\n    const currentCompanion = dialogs.find(dialog => dialog.companion.username === username)?.companion\r\n\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const onNewMessageSubmit = (message: string) => {\r\n        if (message.trim() && currentDialogId) dispatch(sendMessage(message.trim(), currentDialogId))\r\n    }\r\n\r\n    useEffect(() => {\r\n        dispatch(openDialog(username))\r\n        return () => {\r\n            dispatch(closeDialog())\r\n        }\r\n    }, [username, dispatch])\r\n\r\n    useEffect(() => {\r\n        dispatch(getDialogs())\r\n    }, [dispatch])\r\n\r\n    useEffect(() => {\r\n        // console.log('message updated')\r\n        // if (currentDialogId) dispatch(readMessages(currentDialogId))\r\n    }, [messages, dispatch])\r\n\r\n\r\n    const authorized = useAuthCheck()\r\n    if (!authorized) return <Redirect to={'/login'}/>\r\n\r\n\r\n    // if no username specified in route, then redirect to latest dialog\r\n    if (!username && dialogs[0] && dialogs.length !== 0) return <Redirect\r\n        to={`/dialogs/${dialogs[0].companion.username}`}/>\r\n\r\n\r\n    return <>\r\n        {currentCompanion && <Helmet>\r\n            <title>Dialog - {currentCompanion.firstName} {currentCompanion.lastName}</title>\r\n        </Helmet>}\r\n        <Dialogs\r\n        messages={messages}\r\n        dialogs={dialogs}\r\n        currentCompanion={currentCompanion}\r\n        authUser={authUser || ''}\r\n        onNewMessageSubmit={onNewMessageSubmit}\r\n    /></>\r\n}\r\n\r\n\r\nexport default DialogsPage\r\n"],"sourceRoot":""}